<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>教師登入（AJAX）</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
</head>
<body class="container">
  <h1>教師用成績系統 — 登入</h1>

  <div class="card">
    <label>名稱</label>
    <input id="username" type="text" placeholder="teacher1 / teacher2">
    <label>密碼</label>
    <input id="password" type="password" placeholder="123 / 456">
    <button id="loginBtn">登入</button>
  </div>

  <script>
    const $ = s => document.querySelector(s);
    $("#loginBtn").addEventListener("click", async ()=>{
      const username = $("#username").value.trim();
      const password = $("#password").value.trim();
      if(!username || !password){ alert("請輸入名稱與密碼"); return; }

      try{
        const res = await fetch("/api/login", {
          method: "POST",
          headers: {"Content-Type":"application/json"},
          body: JSON.stringify({ username, password })
        });
        const out = await res.json();
        if(!res.ok || !out.ok){ alert(out.msg || "登入失敗"); return; }
        location.href = "/grades"; // 成功直接跳轉
      }catch(e){
        alert("系統錯誤，請稍後再試");
      }
    });
  </script>
</body>
</html>
